<?xml version="1.0" encoding="UTF-8"?>

<!-- Note: sync attribute can be sync, async, or guarded. Only for input />
   Note: priority attribute can be high, medium, low or interrupt. 
         Only valid for active components input.
   Note  kind attribute of component can be ether active or passive.
         -->
<?xml-model href="../../schema/ISF/component_schema.rng" type="application/xml" schematypens="http://relaxng.org/ns/structure/1.0"?>
<component name="RobotArm" kind="active" namespace="RobotArm">
    <import_port_type>RobotArm/ServoPorts/ServoPortAi.xml</import_port_type>
    <import_port_type>Svc/Sched/SchedPortAi.xml</import_port_type>
    <comment>RobotArm component</comment>


    <ports>
        <port name="Run" data_type="Svc::Sched" kind="async_input">
            <comment>
            Input Scheduler port - called at 1Hz and 10Hz
            </comment>
        </port>
        <port name="ServoOutPort" data_type="RobotArm::SetServo" kind="output"  max_number="4">
            <comment>
            Output Port for sending angle to servos
            </comment>
        </port>

    </ports>


    <commands>
        <!-- Command to send a string message -->
        <command kind="async" opcode="0" mnemonic="SET_Arm_Angle">
            <comment>
            Set arm angle
            </comment>
            <args>
                <arg name="angle" type="F32" size="40">
                    <comment>Arm angle</comment>
                </arg>          
             </args>
        </command>
        <command kind="async" opcode="1" mnemonic="SET_Base_Angle">
            <comment>
            Set base angle
            </comment>
            <args>
                <arg name="angle" type="F32" size="40">
                    <comment>Base angle</comment>
                </arg>          
             </args>
        </command>
        <command kind="async" opcode="2" mnemonic="SET_Height_Angle">
            <comment>
            Set height angle
            </comment>
            <args>
                <arg name="angle" type="F32" size="40">
                    <comment>Angle to send</comment>
                </arg>          
             </args>
        </command>
        <command kind="async" opcode="3" mnemonic="SET_Length_Angle">
            <comment>
            Set length angle
            </comment>
            <args>
                <arg name="angle" type="F32" size="40">
                    <comment>Angle to send</comment>
                </arg>          
             </args>
        </command>
    </commands>
    <telemetry>
        <channel id="0" name="Arm_Angle" data_type="F32">
        </channel>
        <channel id="1" name="Base_Angle" data_type="F32">
        </channel>
        <channel id="2" name="Height_Angle" data_type="F32">
        </channel>
        <channel id="3" name="Length_Angle" data_type="F32">
        </channel>
        <channel id="4" name="Sched_Cycles" data_type="I32">
        </channel>
    </telemetry>
    <events>
        <event id="0" name="Sent_Arm_Angle" severity="ACTIVITY_HI" format_string = "Sent arm angle: %f degrees"  >
            <comment>
            Sent arm angle
            </comment>
            <args>
                <arg name="angle" type="F32" size="40">
                    <comment>The angle</comment>
                </arg>          
            </args>
        </event>
        <event id="1" name="Sent_Base_Angle" severity="ACTIVITY_HI" format_string = "Sent base angle: %f degrees"  >
            <comment>
            Sent base angle
            </comment>
            <args>
                <arg name="angle" type="F32" size="40">
                    <comment>The angle</comment>
                </arg>          
            </args>
        </event>
        <event id="2" name="Sent_Height_Angle" severity="ACTIVITY_HI" format_string = "Sent height angle: %f degrees"  >
            <comment>
            Sent height angle
            </comment>
            <args>
                <arg name="angle" type="F32" size="40">
                    <comment>The angle</comment>
                </arg>          
            </args>
        </event>
        <event id="3" name="Sent_Length_Angle" severity="ACTIVITY_HI" format_string = "Sent length angle: %f degrees"  >
            <comment>
            Sent length angle
            </comment>
            <args>
                <arg name="angle" type="F32" size="40">
                    <comment>The angle</comment>
                </arg>          
            </args>
        </event>
    </events>
</component>

